---
import type { Database } from "../db/database.types";

interface Props {
  signals: Database["public"]["Tables"]["signals"]["Row"][];
}

const { signals } = Astro.props;
---

<section class="mt-6 bg-white border border-slate-200 rounded-2xl p-6 shadow-sm">
  <h2 class="text-xl font-semibold mb-4 text-slate-900">Ostatnie sygnały (mock)</h2>
  {
    signals.length === 0 ? (
      <p class="text-sm text-slate-600">
        Brak sygnałów. Jako admin wywołaj endpoint <code>/api/admin/generate-signals</code>, aby wygenerować dane mock.
      </p>
    ) : (
      <div class="overflow-x-auto">
        <table class="w-full text-sm border-collapse">
          <thead class="bg-slate-50">
            <tr class="border-b border-white/10 text-left">
              <th class="py-2 pr-4">Czas (UTC)</th>
              <th class="py-2 pr-4">Typ</th>
              <th class="py-2 pr-4">Pewność</th>
              <th class="py-2 pr-4">Strategia</th>
            </tr>
          </thead>
          <tbody>
            {signals.map((s) => (
              <tr class="border-b last:border-0 border-slate-100 hover:bg-slate-50/80">
                <td class="py-2 pr-4 font-mono text-xs text-slate-700">{new Date(s.ts).toISOString()}</td>
                <td class="py-2 pr-4">
                  <span
                    class:list={[
                      "inline-flex items-center px-2 py-0.5 rounded-full text-xs font-semibold",
                      s.type === "BUY" && "bg-emerald-50 text-emerald-700 border border-emerald-300",
                      s.type === "SELL" && "bg-rose-50 text-rose-700 border border-rose-300",
                      s.type === "HOLD" && "bg-slate-50 text-slate-700 border border-slate-300",
                    ]}
                  >
                    {s.type}
                  </span>
                </td>
                <td class="py-2 pr-4 text-slate-800">{s.confidence}%</td>
                <td class="py-2 pr-4 text-xs font-mono text-slate-600">{s.strategy_id}</td>
              </tr>
            ))}
          </tbody>
        </table>
      </div>
    )
  }
</section>
